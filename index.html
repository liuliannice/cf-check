<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>正在校验浏览器完整性…</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
*{box-sizing:border-box}
body{
    margin:0;
    background:#0b1220;
    color:#e5e7eb;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
    display:flex;
    align-items:center;
    justify-content:center;
    height:100vh;
}
.panel{
    width:380px;
    padding:34px 28px;
    background:#020617;
    border:1px solid #1e293b;
    border-radius:16px;
    box-shadow:0 0 40px rgba(0,0,0,.55);
    text-align:center;
}
.loader{
    width:56px;
    height:56px;
    margin:0 auto 18px;
    border:4px solid #1e293b;
    border-top-color:#38bdf8;
    border-radius:50%;
    animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}
h1{font-size:18px;margin-bottom:12px}
p{font-size:14px;color:#94a3b8;line-height:1.7; min-height:48px;}
.footer{margin-top:18px;font-size:12px;color:#64748b}
.ok{color:#4ade80}
.err{color:#f87171}
.btn{
    display:none;
    margin-top:16px;
    padding:10px 18px;
    border-radius:8px;
    background:#2563eb;
    color:#fff;
    font-size:14px;
    text-decoration:none;
    opacity:0;
    transition:opacity 0.8s;
}
.btn:hover{
    background:#1d4ed8;
}
.footer a{
    color:#38bdf8;
    text-decoration:none;
}
.footer a:hover{
    text-decoration:underline;
}
</style>
</head>
<body>

<div class="panel">
    <div class="loader"></div>
    <h1 id="title">正在校验浏览器完整性…</h1>
    <p id="status">初始化安全模块</p>
    <a id="btn" class="btn" href="javascript:void(0)">如果没有自动跳转，请点击前往</a>
    <div class="footer">
        推荐使用
        <a href="https://www.google.cn/chrome/" target="_blank" rel="noopener">Google Chrome浏览器</a>
        或
        <a href="https://www.mozilla.org/zh-CN/firefox/new/" target="_blank" rel="noopener">Firefox浏览器</a>
        访问本站！
    </div>
</div>

<script>
(function(){

/* ================= 黑名单浏览器列表 ================= */
const blacklist = [
    { name:'微信内置浏览器', ua:/MicroMessenger|WeChat/i },
    { name:'QQ 浏览器', ua:/QQBrowser/i },
    { name:'UC 浏览器', ua:/UCBrowser/i },
    { name:'360 浏览器', ua:/360Browser|QIHU/i },
    { name:'搜狗浏览器', ua:/SogouMobileBrowser/i },
    { name:'夸克浏览器', ua:/Quark/i },
    { name:'华为浏览器', ua:/HuaweiBrowser/i },
    { name:'小米浏览器', ua:/MiuiBrowser/i },
    { name:'OPPO 浏览器', ua:/OppoBrowser/i },
    { name:'Vivo 浏览器', ua:/VivoBrowser/i }
];

/* ================= WebView 检测 ================= */
function isWebView(){
    const ua = navigator.userAgent;
    return /wv|WebView|Android.*Version\//i.test(ua) ||
           (/iPhone|iPad|iPod/i.test(ua) && !/Safari/i.test(ua));
}

/* ================= 检测当前浏览器 ================= */
const ua = navigator.userAgent;
let blocked = blacklist.find(b => b.ua.test(ua));
if(!blocked && isWebView()) blocked = {name:'WebView/非标准浏览器'};

/* ================= 校验动画文字 ================= */
const steps = [
    '校验 TLS 安全连接',
    '分析浏览器执行环境',
    '验证访问完整性',
    '加载风险控制策略'
];
const status = document.getElementById('status');
const title  = document.getElementById('title');
const btn    = document.getElementById('btn');
let stepIndex = 0;

const stepTimer = setInterval(()=>{
    status.textContent = steps[stepIndex++ % steps.length];
}, 400);

/* ================= 跳转地址拆分 ================= */
const urlParts = [
    'aHR0cHM6Ly8=',
    'd3d3Ljk5YXNtci5uZXQ=',
    'Lw=='
];
function buildURL(){ return urlParts.map(p=>atob(p)).join(''); }

/* ================= 缩短总延迟 ================= */
const delay = 1000 + Math.random() * 1000;

setTimeout(()=>{
    clearInterval(stepTimer);

    if(blocked){
        document.querySelector('.loader').remove();
        title.textContent = '安全校验未通过';
        title.className = 'err';
        status.innerHTML = `Sorry！暂不支持「${blocked.name}」访问！<br>请更换浏览器访问！`;
    }else{
        title.textContent = '校验通过';
        title.className = 'ok';
        status.innerHTML = '访问环境安全可信<br>即将进入目标页面…';

        const target = buildURL();

        // 渐显按钮
        btn.style.display = 'inline-block';
        setTimeout(()=>{ btn.style.opacity = 1; }, 300);

        btn.onclick = () => location.href = target;

        setTimeout(()=>{ location.replace(target); }, 1500);
    }
}, delay);

})();
</script>

</body>
</html>
